--- devcodebase/scripts/emergency_optimize.py	2025-06-28 08:28:18.388928765 +0700
+++ scripts/emergency_optimize.py	2025-06-28 15:20:34.535261578 +0700
@@ -30,8 +30,12 @@
             # Limit BM25 results
             'bm25_max_results': '500',     # Add new setting
             'reranking_top_k': '20',       # Reduce reranking load
+            'reranking_device': 'cpu',     # Force CPU to free GPU memory
             'enable_hybrid_search': 'false', # Disable for now
             'query_enhancement_synonyms': 'false', # Reduce expansion
+            # Disable GPU for FAISS in emergencies
+            'faiss_gpu_batch_size': '512',  # Smaller batches
+            'faiss_gpu_use_float16': 'false', # Disable float16
         }
     }
     
@@ -58,6 +62,7 @@
     print("- Reduced memory cache to 50K")
     print("- Reduced batch sizes")
     print("- Disabled query synonyms")
+    print("- Forced CPU mode for reranking and FAISS")
 
 if __name__ == '__main__':
     if len(sys.argv) != 2:
